{% extends "base.html" %}
{% load static %}

{% block title %}Sign Up · DevJobs{% endblock %}

{% block content %}
<div class="container my-5" style="max-width: 760px;">
  <div class="card card-hover">
    <div class="card-body p-4 p-md-5">
      <h1 class="h4 mb-3">Create your account</h1>

      <form method="post" novalidate>
        {% csrf_token %}

        {# Role selector — Recruiter disabled for now #}
        <div class="mb-3">
          <label class="form-label d-block">I am a</label>
          <div class="d-flex gap-3">
            <div class="form-check">
              <input class="form-check-input" type="radio" name="role_choice" id="roleApplicant" value="applicant" checked>
              <label class="form-check-label" for="roleApplicant">Applicant</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" id="roleRecruiter" value="recruiter" disabled>
              <label class="form-check-label text-body-secondary" for="roleRecruiter" title="Coming soon">Recruiter (coming soon)</label>
            </div>
          </div>
          <input type="hidden" name="user_type" id="id_user_type" value="applicant">
        </div>

        {# Account basics #}
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label">Username</label>
            {{ form.username }}
          </div>
          <div class="col-md-6">
            <label class="form-label">Email</label>
            {{ form.email }}
          </div>
          <div class="col-md-6">
            <label class="form-label">Password</label>
            {{ form.password1 }}
          </div>
          <div class="col-md-6">
            <label class="form-label">Confirm Password</label>
            {{ form.password2 }}
          </div>
          <div class="col-md-6">
            <label class="form-label">Phone</label>
            {{ form.phone_number }}
          </div>
        </div>

        <hr class="my-4">

        {# Address #}
        <div class="row g-3">
          <div class="col-md-8">
            <label class="form-label">Street address</label>
            {{ form.street_address }}
          </div>
          <div class="col-md-4">
            <label class="form-label">Zip/Postal Code</label>
            {{ form.zip_code }}
          </div>
          <div class="col-md-4">
            <label class="form-label">City</label>
            {{ form.city }}
          </div>
          <div class="col-md-4">
            <label class="form-label">State</label>
            {{ form.state }}
          </div>
          <div class="col-md-4">
            <label class="form-label">Country</label>
            {{ form.country }}
          </div>
        </div>

        <hr class="my-4">

        {# Applicant details #}
        <div id="applicantFields">
          <label class="form-label">Headline (optional)</label>
          {{ form.headline }}
        </div>

        {# Form errors #}
        {% if form.non_field_errors %}
          <div class="mt-3">
            {{ form.non_field_errors }}
          </div>
        {% endif %}
        {% for field in form %}
          {% for error in field.errors %}
            <div class="alert alert-danger mt-3">{{ error }}</div>
          {% endfor %}
        {% endfor %}

        <div class="d-grid d-md-flex gap-2 mt-4">
          <button class="btn btn-primary px-4" type="submit">Create account</button>
          <a class="btn btn-outline-secondary" href="{% url 'account:login' %}">Have an account? Log in</a>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  // Radio → hidden user_type
  const applicant = document.getElementById('roleApplicant');
  const hiddenType = document.getElementById('id_user_type');
  applicant.addEventListener('change', () => { if (applicant.checked) hiddenType.value = 'applicant'; });
</script>
{% endblock %}
